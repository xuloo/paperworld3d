<?xml version="1.0" encoding="UTF-8"?>
<project name="build-paperworld-server" default="all" basedir="."
    xmlns:ivy="antlib:org.apache.ivy.ant">

    <description>
      PaperWorld3D build and deployment.
    </description>
     <!-- set global properties for this build -->
	<property file="user.properties"/>
	<property file="build.properties"/>
     
     <property environment="env"/>
	 
     
	 
	 
     
     
     <property name="dist.dir" location="${red5.dir}/webapps/HelloPaperWorld/WEB-INF/lib"/>
	 
	 <taskdef name="xmltask" classname="com.oopsconsultancy.xmltask.ant.XmlTask" classpath="buildlib/xmltask-v1.15.1.jar"/>

     <path id="classpath">
       <pathelement location="${red5.dir}/red5.jar"/>
       <pathelement location="lib/jedai.jar"/>
     </path>
	 
	 <target name="all">
		 <antcall target="jar"/>
	 </target>
	 
	 <target name="build-jedai">
		 <ant dir="${jedai.dir}/server/jedai/WEB-INF"/>
	 </target>

     <target name="compile-core" description="compile the source" >
		 
	   <delete dir="${build.dir}"/>
       <mkdir dir="${build.dir}"/>
	   
       <!-- Compile the java code from ${src.dir} into ${build.dir} -->
       <javac srcdir="${paperworld.src.dir}" destdir="${build.dir}" classpathref="classpath"/>
	   
       <!-- copy the logback.xml file here because I want it in our jar -->
       <copy todir="${build.dir}">
         <fileset dir="${config.dir}">
          <include name="logback.xml"/>
         </fileset>
       </copy>

     </target>
	
     <target name="dist" description="generate the distribution" >
 
       <!-- Copy over all the Jar files we need -->
       <copy todir="${jar.dir}" overwrite="true">
         <fileset dir="${output.dir}">
           <include name="*.jar"/>
         </fileset>
       </copy>

     </target>
     	
     <target name="jar">
          	<antcall target="build-core-jar"/>
     </target>

     <target name="build-core-jar" depends="compile-core" description="insert this app into the RED5_HOME service">
          	
		<jar jarfile="${jar.dir}/${core.output.name}.jar" basedir="${build.dir}"/>
	
     </target>

     <target name="clean"
           description="clean up" >
       <!-- Delete the ${build.dir} and ${dist.dir} directory trees -->
       <delete dir="${build.dir}"/>
       <delete dir="${dist.dir}"/>
       <delete dir="${red5.dir}/webapps/${app.name}"/>
     </target>
</project>
